(()=>{(()=>{let o={relays:[],proxies:[],showRelays:!0,showProxies:!0,tailnetFQDN:"",logs:[],logLevel:"INFO",logStream:null,currentEditItem:null,currentEditType:null,deleteTarget:null,removeTlsCert:!1,backups:[],currentView:"dashboard"},s={items:document.getElementById("items"),lastUpdated:document.getElementById("last-updated"),itemCount:document.getElementById("item-count"),alertContainer:document.getElementById("alert-container"),logOutput:document.getElementById("log-output"),logLevel:document.getElementById("log-level"),logLevelSelect:document.getElementById("log-level-select"),refresh:document.getElementById("refresh"),clearLogs:document.getElementById("clear-logs"),filterRelay:document.getElementById("filter-relay"),filterProxy:document.getElementById("filter-proxy"),themeToggle:document.getElementById("theme-toggle"),addRelayBtn:document.getElementById("add-relay-btn"),addProxyBtn:document.getElementById("add-proxy-btn"),saveRelayBtn:document.getElementById("save-relay-btn"),saveProxyBtn:document.getElementById("save-proxy-btn"),confirmDeleteBtn:document.getElementById("confirm-delete-btn"),removeTlsCertBtn:document.getElementById("proxy-tls-cert-remove"),navDashboard:document.getElementById("nav-dashboard"),navBackups:document.getElementById("nav-backups"),dashboardView:document.getElementById("dashboard-view"),backupsView:document.getElementById("backups-view"),backupList:document.getElementById("backup-list"),backupEmptyState:document.getElementById("backup-empty-state"),createBackupBtn:document.getElementById("create-backup-btn"),uploadBackupBtn:document.getElementById("upload-backup-btn"),confirmUploadBtn:document.getElementById("confirm-upload-btn"),uploadBackupForm:document.getElementById("uploadBackupForm"),backupFile:document.getElementById("backupFile")},B=[],C=()=>{let e=localStorage.getItem("theme");return e||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")},x=e=>{document.documentElement.setAttribute("data-bs-theme",e),localStorage.setItem("theme",e),R(e)},R=e=>{if(!s.themeToggle)return;let t=e==="dark"?"bi-moon-stars-fill":"bi-sun-fill";s.themeToggle.querySelector("use").setAttribute("href",`/static/vendor/bootstrap-icons/bootstrap-icons.svg#${t}`)},D=()=>{let t=(document.documentElement.getAttribute("data-bs-theme")||"light")==="dark"?"light":"dark";x(t)},u=async(e,t={})=>{let n=await fetch(e,{credentials:"same-origin",headers:{"Content-Type":"application/json",...t.headers||{}},...t});if(!n.ok){let a=await n.text();throw new Error(a||`Request failed: ${n.status}`)}return n.json()},M=()=>{let e=new Date;s.lastUpdated.textContent=e.toLocaleTimeString()},d=(e,t)=>{let n=document.createElement("div");n.className=`alert alert-${e} alert-dismissible fade show`,n.setAttribute("role","alert"),n.innerHTML=`
      <div>${t}</div>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    `,s.alertContainer.appendChild(n),setTimeout(()=>{n.classList.remove("show"),n.addEventListener("transitionend",()=>n.remove())},6e3)},F=e=>`tcp://${o.tailnetFQDN||"unknown"}:${e.listen_port} \u2192 ${e.target_host}:${e.target_port}`,N=e=>{let t=e.port?`:${e.port}`:"",n=`https://${e.hostname}${t}`;return`<a class="proxy-link" href="${n}" target="_blank" rel="noopener">${n}</a>`},h=e=>{s.items.innerHTML=`
      <div class="col-12">
        <div class="card">
          <div class="card-body text-center text-muted">
            ${e}
          </div>
        </div>
      </div>
    `},E=()=>{Q();let t=[...o.relays.map(n=>({type:"relay",relay:n.relay,running:n.running})),...o.proxies.map(n=>({type:"proxy",proxy:n}))].filter(n=>n.type==="relay"?o.showRelays:o.showProxies);if(s.itemCount.textContent=`${t.length} item${t.length===1?"":"s"}`,!t.length){!o.showRelays&&!o.showProxies?h("Enable TCP relays or HTTPS proxies to view items."):o.showRelays&&!o.showProxies?h("No TCP relays configured."):!o.showRelays&&o.showProxies?h("No HTTPS proxies configured."):h("No relays or proxies configured.");return}s.items.innerHTML=t.map(n=>{var y,m,f;if(n.type==="relay"){let p=n.relay,v=n.running,le=v?"text-bg-success":"text-bg-secondary",de=(y=p.autostart)!=null?y:!1;return`
            <div class="col-12">
              <div class="card h-100">
                <div class="card-body d-flex flex-column flex-lg-row align-items-lg-center gap-3">
                  <div class="flex-grow-1">
                    <div class="d-flex align-items-center gap-2 flex-wrap">
                      <svg class="bi text-primary" data-bs-toggle="tooltip" title="TCP Relay (served by socat)" aria-hidden="true" style="width: 1.25em; height: 1.25em;"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-diagram-3"></use></svg>
                      <span class="fw-semibold">${F(p)}</span>
                    </div>
                  </div>
                  <div class="d-flex align-items-center gap-2">
                    <span class="badge ${le}">${v?"Running":"Stopped"}</span>
                    <div class="form-check form-switch m-0" data-bs-toggle="tooltip" title="Start automatically on container boot">
                      <input class="form-check-input autostart-toggle" type="checkbox" role="switch" 
                             ${de?"checked":""} 
                             data-type="relay" data-id="${p.id}">
                      <label class="form-check-label small text-muted">Autostart</label>
                    </div>
                    <button class="btn btn-outline-secondary btn-sm action-btn" data-type="relay" data-id="${p.id}" data-running="${v}">
                      <svg class="bi me-1" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#${v?"bi-pause-fill":"bi-play-fill"}"></use></svg>
                      ${v?"Pause":"Start"}
                    </button>
                    <button class="btn btn-outline-primary btn-sm edit-btn" data-type="relay" data-id="${p.id}">
                      <svg class="bi" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-pencil"></use></svg>
                    </button>
                    <button class="btn btn-outline-danger btn-sm delete-btn" data-type="relay" data-id="${p.id}" data-name="tcp://${o.tailnetFQDN}:${p.listen_port}">
                      <svg class="bi" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-trash"></use></svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          `}let a=n.proxy,l=(m=a.running)!=null?m:a.Running,r=l?"text-bg-success":"text-bg-secondary",c=l?"Running":"Stopped",i=(f=a.autostart)!=null?f:!1,b=a.port?`${a.hostname}:${a.port}`:a.hostname;return`
          <div class="col-12">
            <div class="card h-100">
              <div class="card-body d-flex flex-column flex-lg-row align-items-lg-center gap-3">
                <div class="flex-grow-1">
                  <div class="d-flex align-items-center gap-2 flex-wrap">
                    <svg class="bi text-primary" data-bs-toggle="tooltip" title="HTTPS Proxy (served by Caddy)" aria-hidden="true" style="width: 1.25em; height: 1.25em;"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-shield-lock"></use></svg>
                    <span class="fw-semibold">${N(a)} \u2192 ${a.target}</span>
                  </div>
                </div>
                <div class="d-flex align-items-center gap-2">
                  <span class="badge ${r}">${c}</span>
                  <div class="form-check form-switch m-0" data-bs-toggle="tooltip" title="Start automatically on container boot">
                    <input class="form-check-input autostart-toggle" type="checkbox" role="switch" 
                           ${i?"checked":""} 
                           data-type="proxy" data-id="${a.id}">
                    <label class="form-check-label small text-muted">Autostart</label>
                  </div>
                  <button class="btn btn-outline-secondary btn-sm action-btn" data-type="proxy" data-id="${a.id}" data-enabled="${a.enabled}">
                    <svg class="bi me-1" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#${a.enabled?"bi-pause-fill":"bi-play-fill"}"></use></svg>
                    ${a.enabled?"Pause":"Start"}
                  </button>
                  <button class="btn btn-outline-primary btn-sm edit-btn" data-type="proxy" data-id="${a.id}">
                    <svg class="bi" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-pencil"></use></svg>
                  </button>
                  <button class="btn btn-outline-danger btn-sm delete-btn" data-type="proxy" data-id="${a.id}" data-name="https://${b}">
                    <svg class="bi" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-trash"></use></svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `}).join(""),j()},O=()=>{let e=s.backupList;if(e){if(e.innerHTML="",!o.backups.length){s.backupEmptyState.classList.remove("d-none");return}s.backupEmptyState.classList.add("d-none"),o.backups.forEach(t=>{var c;let n=document.createElement("tr"),a=new Date(t.Timestamp),l=_(t.Size),r=((c=t.Metadata)==null?void 0:c.BackupType)||"full";n.innerHTML=`
        <td><strong>${t.Filename}</strong></td>
        <td>${l}</td>
        <td>${a.toLocaleString()}</td>
        <td><span class="badge text-bg-secondary">${r}</span></td>
        <td class="text-end">
          <button class="btn btn-sm btn-outline-primary download-backup-btn me-1" data-filename="${t.Filename}">
            <svg class="bi me-1" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-download"></use></svg>
            Download
          </button>
          <button class="btn btn-sm btn-outline-warning restore-backup-btn me-1" data-filename="${t.Filename}">
            <svg class="bi me-1" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-arrow-counterclockwise"></use></svg>
            Restore
          </button>
          <button class="btn btn-sm btn-outline-danger delete-backup-btn" data-filename="${t.Filename}">
            <svg class="bi" aria-hidden="true"><use href="/static/vendor/bootstrap-icons/bootstrap-icons.svg#bi-trash"></use></svg>
          </button>
        </td>
      `,e.appendChild(n)})}},_=e=>{if(e===0)return"0 B";let t=1024,n=["B","KB","MB","GB","TB"],a=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,a)).toFixed(1))+" "+n[a]},k=e=>{o.currentView=e,e==="dashboard"?(s.navDashboard.classList.add("active"),s.navBackups.classList.remove("active"),s.dashboardView.classList.remove("d-none"),s.backupsView.classList.add("d-none"),document.querySelector(".fab-container").classList.remove("d-none")):(s.navDashboard.classList.remove("active"),s.navBackups.classList.add("active"),s.dashboardView.classList.add("d-none"),s.backupsView.classList.remove("d-none"),document.querySelector(".fab-container").classList.add("d-none"),w())},w=async()=>{try{let e=await u("/api/backup/list");o.backups=e.backups||[],O()}catch(e){d("danger","Failed to load backups: "+e.message)}},U=async()=>{if(confirm("Create a new full system backup?"))try{s.createBackupBtn.disabled=!0,await u("/api/backup/create",{method:"POST",body:JSON.stringify({backup_type:"full"})}),d("success","Backup created successfully"),await w()}catch(e){d("danger",e.message)}finally{s.createBackupBtn.disabled=!1}},A=()=>{let e=new bootstrap.Modal(document.getElementById("uploadBackupModal"));s.uploadBackupForm.reset(),e.show()},q=async()=>{let e=s.backupFile;if(!e.files.length){d("warning","Please select a file");return}let t=e.files[0],n=new FormData;n.append("backup",t);try{s.confirmUploadBtn.disabled=!0;let a=await fetch("/api/backup/upload",{method:"POST",body:n,headers:{}});if(!a.ok)throw new Error(await a.text());let r=(await a.json()).filename;d("info","Upload successful. Restoring..."),await u("/api/backup/restore",{method:"POST",body:JSON.stringify({filename:r})}),bootstrap.Modal.getInstance(document.getElementById("uploadBackupModal")).hide(),d("success","System restored successfully. Reloading..."),setTimeout(()=>location.reload(),2e3)}catch(a){d("danger","Operation failed: "+a.message),s.confirmUploadBtn.disabled=!1}},H=async e=>{if(confirm(`Restore from backup "${e}"? Current configuration will be overwritten.`))try{await u("/api/backup/restore",{method:"POST",body:JSON.stringify({filename:e})}),d("success","System restored successfully. Reloading..."),setTimeout(()=>location.reload(),2e3)}catch(t){d("danger",t.message)}},V=async e=>{if(confirm(`Delete backup "${e}"?`))try{await u(`/api/backup/delete?filename=${encodeURIComponent(e)}`,{method:"DELETE"}),d("success","Backup deleted"),await w()}catch(t){d("danger",t.message)}},J=e=>{window.location.href=`/api/backup/download?filename=${encodeURIComponent(e)}`},z=e=>{let t=e.target.closest("button");if(!t)return;let n=t.dataset.filename;t.classList.contains("download-backup-btn")?J(n):t.classList.contains("restore-backup-btn")?H(n):t.classList.contains("delete-backup-btn")&&V(n)},j=()=>{document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(e=>{B.push(new bootstrap.Tooltip(e))})},Q=()=>{for(;B.length;)B.pop().dispose()},g=async()=>{try{let[e,t,n]=await Promise.all([u("/api/socat/relays"),u("/api/caddy/proxies"),u("/api/tailscale/status")]);o.relays=e.map(a=>{var l;return{relay:a.Relay||a.relay,running:(l=a.Running)!=null?l:a.running}}),o.proxies=t.map(a=>{var l;return{...a,running:(l=a.running)!=null?l:a.Running}}),o.tailnetFQDN=n.MagicDNSName||n.magicDNSName||"",E(),M()}catch(e){d("danger",e.message)}},G=async(e,t)=>{let n=t?`/api/socat/stop?id=${encodeURIComponent(e)}`:`/api/socat/start?id=${encodeURIComponent(e)}`;await u(n,{method:"POST"})},K=async(e,t)=>{await u("/api/caddy/toggle",{method:"POST",body:JSON.stringify({id:e,enabled:!t})})},W=async(e,t,n)=>{var c;let a=e==="relay"?"/api/socat/update":"/api/caddy/update",l=e==="relay"?(c=o.relays.find(i=>i.relay.id===t))==null?void 0:c.relay:o.proxies.find(i=>i.id===t);if(!l)throw new Error(`${e} not found`);let r={...l,autostart:n};await u(a,{method:"POST",body:JSON.stringify(r)})},X=async e=>{let t=e.target.closest(".action-btn");if(!t)return;t.disabled=!0;let n=t.dataset.type;try{if(n==="relay"){let a=t.dataset.running==="true";await G(t.dataset.id,a)}else{let a=t.dataset.enabled==="true";await K(t.dataset.id,a)}await g()}catch(a){d("danger",a.message)}finally{t.disabled=!1}},Y=async e=>{let t=e.target;if(!t.classList.contains("autostart-toggle"))return;let{type:n,id:a}=t.dataset,l=t.checked;t.disabled=!0;try{await W(n,a,l),await g()}catch(r){d("danger",r.message),t.checked=!l}finally{t.disabled=!1}},I=e=>{if(!e||!e.message)return;let n=(e.timestamp?new Date(e.timestamp):new Date).toLocaleTimeString(),a=e.source?` [${e.source}]`:"",l=`${n} [${e.level}]${a} ${e.message}`,r=s.logOutput,c=r.scrollTop+r.clientHeight>=r.scrollHeight-8;r.textContent+=`${l}
`,c&&(r.scrollTop=r.scrollHeight)},Z=async()=>{try{let e=await u("/api/logs");o.logs=e.logs||[],o.logLevel=e.level||"INFO",s.logLevel.textContent=o.logLevel,s.logLevelSelect&&(s.logLevelSelect.value=o.logLevel),s.logOutput.textContent="",o.logs.forEach(I)}catch(e){d("warning",e.message)}},ee=async e=>{try{let t=await u("/api/logs/level",{method:"POST",body:JSON.stringify({level:e})});o.logLevel=t.level||e,s.logLevel.textContent=o.logLevel,s.logLevelSelect&&(s.logLevelSelect.value=o.logLevel)}catch(t){d("warning",t.message)}},te=()=>{o.logStream&&o.logStream.close();let e=new EventSource("/api/logs/stream");e.onmessage=t=>{try{let n=JSON.parse(t.data);if(n.connected)return;I(n)}catch{}},e.onerror=()=>{d("warning","Log stream disconnected. Retrying...")},o.logStream=e},L=(e=null)=>{var a;let t=new bootstrap.Modal(document.getElementById("relayModal")),n=document.querySelector("#relayModal .modal-title");o.currentEditItem=e,o.currentEditType="relay",e?(n.textContent="Edit Relay",document.getElementById("relay-id").value=e.id,document.getElementById("relay-listen-port").value=e.listen_port,document.getElementById("relay-target-host").value=e.target_host,document.getElementById("relay-target-port").value=e.target_port,document.getElementById("relay-autostart").checked=(a=e.autostart)!=null?a:!1):(n.textContent="Add Relay",document.getElementById("relayForm").reset(),document.getElementById("relay-id").value="",document.getElementById("relay-autostart").checked=!0),t.show()},$=(e=null)=>{var c,i;let t=new bootstrap.Modal(document.getElementById("proxyModal")),n=document.querySelector("#proxyModal .modal-title"),a=document.getElementById("proxy-tls-cert-current"),l=document.getElementById("proxy-tls-cert-filename"),r=document.getElementById("proxy-tls-cert");if(o.currentEditItem=e,o.currentEditType="proxy",o.removeTlsCert=!1,e)if(n.textContent="Edit Proxy",document.getElementById("proxy-id").value=e.id,document.getElementById("proxy-port").value=e.port||"",document.getElementById("proxy-target").value=e.target,document.getElementById("proxy-trusted-proxies").checked=(c=e.trusted_proxies)!=null?c:!1,document.getElementById("proxy-autostart").checked=(i=e.autostart)!=null?i:!1,r.value="",e.tls_cert_file){let b=e.tls_cert_file.split("/").pop();l.textContent=b,a.style.display="flex"}else a.style.display="none";else n.textContent="Add Proxy",document.getElementById("proxyForm").reset(),document.getElementById("proxy-id").value="",document.getElementById("proxy-autostart").checked=!0,r.value="",a.style.display="none";t.show()},T=async()=>{let e=document.getElementById("relay-id").value,t=parseInt(document.getElementById("relay-listen-port").value),n=document.getElementById("relay-target-host").value.trim(),a=parseInt(document.getElementById("relay-target-port").value),l=document.getElementById("relay-autostart").checked;if(!t||!n||!a){d("danger","Please fill in all required fields");return}let r={listen_port:t,target_host:n,target_port:a,autostart:l,enabled:!0};e&&(r.id=e);try{s.saveRelayBtn.disabled=!0,await u(e?"/api/socat/update":"/api/socat/create",{method:"POST",body:JSON.stringify(r)}),bootstrap.Modal.getInstance(document.getElementById("relayModal")).hide(),d("success",`Relay ${e?"updated":"created"} successfully`),await g()}catch(c){d("danger",c.message)}finally{s.saveRelayBtn.disabled=!1}},S=async()=>{let e=document.getElementById("proxy-id").value,t=document.getElementById("proxy-port").value.trim(),n=document.getElementById("proxy-target").value.trim(),a=document.getElementById("proxy-trusted-proxies").checked,l=document.getElementById("proxy-autostart").checked,r=document.getElementById("proxy-tls-cert").files[0],c=o.tailnetFQDN.replace(/\.$/,"");if(!c){d("danger","MagicDNS hostname not available. Please ensure Tailscale is connected.");return}if(!n){d("danger","Please fill in the target URL");return}if(r){let y=[".pem",".crt",".cer"],m=r.name.toLowerCase();if(!y.some(p=>m.endsWith(p))){d("danger","Invalid certificate file. Please upload a .pem, .crt, or .cer file.");return}if(r.size>1024*1024){d("danger","Certificate file too large. Maximum size is 1MB.");return}}let i=new FormData;if(i.append("hostname",c),i.append("target",n),i.append("trusted_proxies",a.toString()),i.append("autostart",l.toString()),i.append("enabled","true"),!t){d("danger","Port is required");return}let b=parseInt(t);if([80,443,8021].includes(b)){d("danger","Ports 80, 443, and 8021 are reserved and cannot be used");return}i.append("port",t),e&&i.append("id",e),r&&i.append("tls_cert_upload",r),o.removeTlsCert&&i.append("remove_tls_cert","true");try{s.saveProxyBtn.disabled=!0;let m=await fetch(e?"/api/caddy/update":"/api/caddy/create",{method:"POST",credentials:"same-origin",body:i});if(!m.ok){let f=await m.text();throw new Error(f||`Request failed: ${m.status}`)}await m.json(),bootstrap.Modal.getInstance(document.getElementById("proxyModal")).hide(),d("success",`Proxy ${e?"updated":"created"} successfully`),await g()}catch(y){d("danger",y.message)}finally{s.saveProxyBtn.disabled=!1}},ae=(e,t,n)=>{let a=new bootstrap.Modal(document.getElementById("deleteModal")),l=document.getElementById("delete-message");o.deleteTarget={type:e,id:t},l.textContent=`Are you sure you want to delete ${e==="relay"?"relay":"proxy"} "${n}"? This action cannot be undone.`,a.show()},ne=async()=>{if(!o.deleteTarget)return;let{type:e,id:t}=o.deleteTarget;try{s.confirmDeleteBtn.disabled=!0;let n=e==="relay"?`/api/socat/delete?id=${encodeURIComponent(t)}`:`/api/caddy/delete?id=${encodeURIComponent(t)}`;await u(n,{method:"POST"}),bootstrap.Modal.getInstance(document.getElementById("deleteModal")).hide(),d("success",`${e==="relay"?"Relay":"Proxy"} deleted successfully`),await g()}catch(n){d("danger",n.message)}finally{s.confirmDeleteBtn.disabled=!1,o.deleteTarget=null}},se=async e=>{var l;let t=e.target.closest(".edit-btn");if(!t)return;let n=t.dataset.type,a=t.dataset.id;if(n==="relay"){let r=(l=o.relays.find(c=>c.relay.id===a))==null?void 0:l.relay;r&&L(r)}else if(n==="proxy"){let r=o.proxies.find(c=>c.id===a);r&&$(r)}},oe=async e=>{let t=e.target.closest(".delete-btn");if(!t)return;let n=t.dataset.type,a=t.dataset.id,l=t.dataset.name;ae(n,a,l)},re=()=>{var t,n;s.items.addEventListener("click",X),s.items.addEventListener("click",se),s.items.addEventListener("click",oe),s.items.addEventListener("change",Y),s.filterRelay.addEventListener("change",()=>{o.showRelays=s.filterRelay.checked,E()}),s.filterProxy.addEventListener("change",()=>{o.showProxies=s.filterProxy.checked,E()}),s.themeToggle&&s.themeToggle.addEventListener("click",D),s.refresh.addEventListener("click",g),s.clearLogs.addEventListener("click",()=>{s.logOutput.textContent=""}),s.logLevelSelect&&s.logLevelSelect.addEventListener("change",a=>{ee(a.target.value)}),s.addRelayBtn&&s.addRelayBtn.addEventListener("click",a=>{a.preventDefault(),L()}),s.addProxyBtn&&s.addProxyBtn.addEventListener("click",a=>{a.preventDefault(),$()}),s.saveRelayBtn&&s.saveRelayBtn.addEventListener("click",T),s.saveProxyBtn&&s.saveProxyBtn.addEventListener("click",S),s.confirmDeleteBtn&&s.confirmDeleteBtn.addEventListener("click",ne),s.removeTlsCertBtn&&s.removeTlsCertBtn.addEventListener("click",()=>{o.removeTlsCert=!0,document.getElementById("proxy-tls-cert-current").style.display="none",d("info","Certificate will be removed when you save the proxy.")}),(t=document.getElementById("relayForm"))==null||t.addEventListener("submit",a=>{a.preventDefault(),T()}),(n=document.getElementById("proxyForm"))==null||n.addEventListener("submit",a=>{a.preventDefault(),S()}),s.navDashboard&&s.navDashboard.addEventListener("click",a=>{a.preventDefault(),k("dashboard")}),s.navBackups&&s.navBackups.addEventListener("click",a=>{a.preventDefault(),k("backups")}),s.createBackupBtn&&s.createBackupBtn.addEventListener("click",U),s.uploadBackupBtn&&s.uploadBackupBtn.addEventListener("click",A),s.confirmUploadBtn&&s.confirmUploadBtn.addEventListener("click",q),s.backupList&&s.backupList.addEventListener("click",z);let e=document.getElementById("nav-brand");e&&e.addEventListener("click",a=>{a.preventDefault(),k("dashboard")})},P=async()=>{x(C()),re(),await g(),await Z(),te(),setInterval(g,15e3)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",P):P()})();})();
